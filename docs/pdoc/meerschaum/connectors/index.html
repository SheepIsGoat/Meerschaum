<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>meerschaum.connectors API documentation</title>
<meta name="description" content="Create connectors with `meerschaum.connectors.get_connector()`.
For ease of use, you can also import from the root `meerschaum` module:
```
&gt;&gt;&gt; from â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>meerschaum.connectors</code></h1>
</header>
<section id="section-intro">
<p>Create connectors with <code><a title="meerschaum.connectors.get_connector" href="#meerschaum.connectors.get_connector">get_connector()</a></code>.
For ease of use, you can also import from the root <code><a title="meerschaum" href="../index.html">meerschaum</a></code> module:</p>
<pre><code>&gt;&gt;&gt; from meerschaum import get_connector
&gt;&gt;&gt; conn = get_connector()
</code></pre>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#! /usr/bin/env python
# -*- coding: utf-8 -*-
# vim:fenc=utf-8

&#34;&#34;&#34;
Create connectors with `meerschaum.connectors.get_connector()`.
For ease of use, you can also import from the root `meerschaum` module:
```
&gt;&gt;&gt; from meerschaum import get_connector
&gt;&gt;&gt; conn = get_connector()
```
&#34;&#34;&#34;

from __future__ import annotations
from meerschaum.utils.typing import Any, SuccessTuple, Union, Optional, Sequence, Mapping

from meerschaum.connectors.Connector import Connector

### store connectors partitioned by
### type, label for reuse
connectors = {
    &#39;api&#39;    : dict(),
    &#39;sql&#39;    : dict(),
    &#39;mqtt&#39;   : dict(),
    &#39;plugin&#39; : dict(),
}
### fill this with classes only on execution
### for lazy loading
types = dict()

def get_connector(
        type : str = None,
        label : str = None,
        refresh : bool = False,
        debug : bool = False,
        **kw : Any
    ):
    &#34;&#34;&#34;
    Return existing connector or create new connection and store for reuse.

    You can create new connectors if enough parameters are provided for the given type and flavor.

    For example, the following parameters would create a new SQLConnector that isn&#39;t in the configuration file.
    
    ```
    &gt;&gt;&gt; conn = get_connector(
    ...     type = &#39;sql&#39;,
    ...     label = &#39;newlabel&#39;,
    ...     flavor = &#39;sqlite&#39;,
    ...     database = &#39;/file/path/to/database.db&#39;
    ... )
    &gt;&gt;&gt; 
    ```

    :param type:
        Connector type (sql, api, etc.). Defaults to the type of the configured `instance_connector`.
    
    :param label:
        Connector label (e.g. main). Defaults to `&#39;main&#39;`.

    :param refresh:
        Refresh the Connector instance / construct new object. Defaults to `False`.

    :param kw:
        Other arguments to pass to the Connector constructor.
        If the Connector has already been constructed and new arguments are provided,
        refresh is set to True and the old Connector is replaced.

    &#34;&#34;&#34;
    from meerschaum.config import get_config
    if type is None and label is None:
        default_instance_keys = get_config(&#39;meerschaum&#39;, &#39;instance&#39;, patch=True)
        ### recursive call to get_connector
        return parse_instance_keys(default_instance_keys)

    ### NOTE: the default instance connector may not be main.
    ### Only fall back to &#39;main&#39; if the type is provided by the label is omitted.
    if label is None:
        label = &#39;main&#39;

    global types, connectors

    ### type might actually be a label. Check if so and raise a warning.
    if type not in connectors:
        possibilities, poss_msg = [], &#34;&#34;
        for _type in get_config(&#39;meerschaum&#39;, &#39;connectors&#39;):
            if type in get_config(&#39;meerschaum&#39;, &#39;connectors&#39;, _type):
                possibilities.append(f&#34;{_type}:{type}&#34;)
        if len(possibilities) &gt; 0:
            poss_msg = &#34; Did you mean&#34;
            for poss in possibilities[:-1]:
                poss_msg += f&#34; &#39;{poss}&#39;,&#34;
            if poss_msg.endswith(&#39;,&#39;): poss_msg = poss_msg[:-1]
            if len(possibilities) &gt; 1: poss_msg += &#34; or&#34;
            poss_msg += f&#34; &#39;{possibilities[-1]}&#39;?&#34;

        from meerschaum.utils.warnings import warn
        warn(f&#34;Cannot create Connector of type &#39;{type}&#39;.&#34; + poss_msg, stack=False)
        return None

    if len(types) == 0:
        from meerschaum.connectors.sql import SQLConnector
        from meerschaum.connectors.api import APIConnector
        from meerschaum.connectors.mqtt import MQTTConnector
        from meerschaum.connectors.plugin import PluginConnector
        types = {
            &#39;api&#39;    : APIConnector,
            &#39;sql&#39;    : SQLConnector,
            &#39;mqtt&#39;   : MQTTConnector,
            &#39;plugin&#39; : PluginConnector,
        }
    
    ### always refresh MQTT Connectors NOTE: test this!
    if type == &#39;mqtt&#39;: refresh = True

    ### determine if we need to call the constructor
    if not refresh:
        ### see if any user-supplied arguments differ from the existing instance
        if label in connectors[type]:
            warning_message = None
            for attribute, value in kw.items():
                if attribute not in connectors[type][label].__dict__:
                    warning_message = (
                        f&#34;Received new attribute &#39;{attribute}&#39; not present in connector &#34; +
                        f&#34;{connectors[type][label]}.\n&#34;
                    )
                elif connectors[type][label].__dict__[attribute] != value:
                    warning_message = (
                        f&#34;Mismatched values for attribute &#39;{attribute}&#39; in connector &#39;{connectors[type][label]}&#39;.\n&#34; +
                        f&#34;  - Keyword value: &#39;{value}&#39;\n&#34; +
                        f&#34;  - Existing value: &#39;{connectors[type][label].__dict__[attribute]}&#39;\n&#34;
                    )
            if warning_message is not None:
                from meerschaum.utils.warnings import warn
                warning_message += f&#34;\nSetting `refresh` to True and recreating connector with type: &#39;{type}&#39; and label &#39;{label}&#39;&#34;
                refresh = True
                warn(warning_message)
        else: ### connector doesn&#39;t yet exist
            refresh = True

    ### only create an object if refresh is True (can be manually specified, otherwise determined above)
    from meerschaum.utils.warnings import error
    import traceback
    error_msg = None
    if refresh:
        ### will raise an error if configuration is incorrect / missing
        conn = types[type](label=label, debug=debug, **kw)
        connectors[type][label] = conn

    return connectors[type][label]</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="meerschaum.connectors.Connector" href="Connector.html">meerschaum.connectors.Connector</a></code></dt>
<dd>
<div class="desc"><p>Generic Connector parent class. Reads attributes from the configuration.
Consult implemented child classes like SQLConnector, APIConnector, â€¦</p></div>
</dd>
<dt><code class="name"><a title="meerschaum.connectors.api" href="api/index.html">meerschaum.connectors.api</a></code></dt>
<dd>
<div class="desc"><p>Interact with the Meerschaum API (send commands, pull data, etc.)</p></div>
</dd>
<dt><code class="name"><a title="meerschaum.connectors.mqtt" href="mqtt/index.html">meerschaum.connectors.mqtt</a></code></dt>
<dd>
<div class="desc"><p>Read data from MQTT topics.</p></div>
</dd>
<dt><code class="name"><a title="meerschaum.connectors.parse" href="parse.html">meerschaum.connectors.parse</a></code></dt>
<dd>
<div class="desc"><p>Utility functions for parsing connector keys.</p></div>
</dd>
<dt><code class="name"><a title="meerschaum.connectors.plugin" href="plugin/index.html">meerschaum.connectors.plugin</a></code></dt>
<dd>
<div class="desc"><p>Allow pipes to source data from installed plugins.</p></div>
</dd>
<dt><code class="name"><a title="meerschaum.connectors.sql" href="sql/index.html">meerschaum.connectors.sql</a></code></dt>
<dd>
<div class="desc"><p>Subpackage for SQLConnector subclass</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="meerschaum.connectors.get_connector"><code class="name flex">
<span>def <span class="ident">get_connector</span></span>(<span>type:Â strÂ =Â None, label:Â strÂ =Â None, refresh:Â boolÂ =Â False, debug:Â boolÂ =Â False, **kw:Â Any)</span>
</code></dt>
<dd>
<div class="desc"><p>Return existing connector or create new connection and store for reuse.</p>
<p>You can create new connectors if enough parameters are provided for the given type and flavor.</p>
<p>For example, the following parameters would create a new SQLConnector that isn't in the configuration file.</p>
<pre><code>&gt;&gt;&gt; conn = get_connector(
...     type = 'sql',
...     label = 'newlabel',
...     flavor = 'sqlite',
...     database = '/file/path/to/database.db'
... )
&gt;&gt;&gt; 
</code></pre>
<p>:param type:
Connector type (sql, api, etc.). Defaults to the type of the configured <code>instance_connector</code>.</p>
<p>:param label:
Connector label (e.g. main). Defaults to <code>'main'</code>.</p>
<p>:param refresh:
Refresh the Connector instance / construct new object. Defaults to <code>False</code>.</p>
<p>:param kw:
Other arguments to pass to the Connector constructor.
If the Connector has already been constructed and new arguments are provided,
refresh is set to True and the old Connector is replaced.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_connector(
        type : str = None,
        label : str = None,
        refresh : bool = False,
        debug : bool = False,
        **kw : Any
    ):
    &#34;&#34;&#34;
    Return existing connector or create new connection and store for reuse.

    You can create new connectors if enough parameters are provided for the given type and flavor.

    For example, the following parameters would create a new SQLConnector that isn&#39;t in the configuration file.
    
    ```
    &gt;&gt;&gt; conn = get_connector(
    ...     type = &#39;sql&#39;,
    ...     label = &#39;newlabel&#39;,
    ...     flavor = &#39;sqlite&#39;,
    ...     database = &#39;/file/path/to/database.db&#39;
    ... )
    &gt;&gt;&gt; 
    ```

    :param type:
        Connector type (sql, api, etc.). Defaults to the type of the configured `instance_connector`.
    
    :param label:
        Connector label (e.g. main). Defaults to `&#39;main&#39;`.

    :param refresh:
        Refresh the Connector instance / construct new object. Defaults to `False`.

    :param kw:
        Other arguments to pass to the Connector constructor.
        If the Connector has already been constructed and new arguments are provided,
        refresh is set to True and the old Connector is replaced.

    &#34;&#34;&#34;
    from meerschaum.config import get_config
    if type is None and label is None:
        default_instance_keys = get_config(&#39;meerschaum&#39;, &#39;instance&#39;, patch=True)
        ### recursive call to get_connector
        return parse_instance_keys(default_instance_keys)

    ### NOTE: the default instance connector may not be main.
    ### Only fall back to &#39;main&#39; if the type is provided by the label is omitted.
    if label is None:
        label = &#39;main&#39;

    global types, connectors

    ### type might actually be a label. Check if so and raise a warning.
    if type not in connectors:
        possibilities, poss_msg = [], &#34;&#34;
        for _type in get_config(&#39;meerschaum&#39;, &#39;connectors&#39;):
            if type in get_config(&#39;meerschaum&#39;, &#39;connectors&#39;, _type):
                possibilities.append(f&#34;{_type}:{type}&#34;)
        if len(possibilities) &gt; 0:
            poss_msg = &#34; Did you mean&#34;
            for poss in possibilities[:-1]:
                poss_msg += f&#34; &#39;{poss}&#39;,&#34;
            if poss_msg.endswith(&#39;,&#39;): poss_msg = poss_msg[:-1]
            if len(possibilities) &gt; 1: poss_msg += &#34; or&#34;
            poss_msg += f&#34; &#39;{possibilities[-1]}&#39;?&#34;

        from meerschaum.utils.warnings import warn
        warn(f&#34;Cannot create Connector of type &#39;{type}&#39;.&#34; + poss_msg, stack=False)
        return None

    if len(types) == 0:
        from meerschaum.connectors.sql import SQLConnector
        from meerschaum.connectors.api import APIConnector
        from meerschaum.connectors.mqtt import MQTTConnector
        from meerschaum.connectors.plugin import PluginConnector
        types = {
            &#39;api&#39;    : APIConnector,
            &#39;sql&#39;    : SQLConnector,
            &#39;mqtt&#39;   : MQTTConnector,
            &#39;plugin&#39; : PluginConnector,
        }
    
    ### always refresh MQTT Connectors NOTE: test this!
    if type == &#39;mqtt&#39;: refresh = True

    ### determine if we need to call the constructor
    if not refresh:
        ### see if any user-supplied arguments differ from the existing instance
        if label in connectors[type]:
            warning_message = None
            for attribute, value in kw.items():
                if attribute not in connectors[type][label].__dict__:
                    warning_message = (
                        f&#34;Received new attribute &#39;{attribute}&#39; not present in connector &#34; +
                        f&#34;{connectors[type][label]}.\n&#34;
                    )
                elif connectors[type][label].__dict__[attribute] != value:
                    warning_message = (
                        f&#34;Mismatched values for attribute &#39;{attribute}&#39; in connector &#39;{connectors[type][label]}&#39;.\n&#34; +
                        f&#34;  - Keyword value: &#39;{value}&#39;\n&#34; +
                        f&#34;  - Existing value: &#39;{connectors[type][label].__dict__[attribute]}&#39;\n&#34;
                    )
            if warning_message is not None:
                from meerschaum.utils.warnings import warn
                warning_message += f&#34;\nSetting `refresh` to True and recreating connector with type: &#39;{type}&#39; and label &#39;{label}&#39;&#34;
                refresh = True
                warn(warning_message)
        else: ### connector doesn&#39;t yet exist
            refresh = True

    ### only create an object if refresh is True (can be manually specified, otherwise determined above)
    from meerschaum.utils.warnings import error
    import traceback
    error_msg = None
    if refresh:
        ### will raise an error if configuration is incorrect / missing
        conn = types[type](label=label, debug=debug, **kw)
        connectors[type][label] = conn

    return connectors[type][label]</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="meerschaum" href="../index.html">meerschaum</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="meerschaum.connectors.Connector" href="Connector.html">meerschaum.connectors.Connector</a></code></li>
<li><code><a title="meerschaum.connectors.api" href="api/index.html">meerschaum.connectors.api</a></code></li>
<li><code><a title="meerschaum.connectors.mqtt" href="mqtt/index.html">meerschaum.connectors.mqtt</a></code></li>
<li><code><a title="meerschaum.connectors.parse" href="parse.html">meerschaum.connectors.parse</a></code></li>
<li><code><a title="meerschaum.connectors.plugin" href="plugin/index.html">meerschaum.connectors.plugin</a></code></li>
<li><code><a title="meerschaum.connectors.sql" href="sql/index.html">meerschaum.connectors.sql</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="meerschaum.connectors.get_connector" href="#meerschaum.connectors.get_connector">get_connector</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>